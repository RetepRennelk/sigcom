import numpy as np
from sigcom.util.general import Struct


def atsc_NUCs_NERC(M, CR):
    if M == 16:
        if CR == [5, 15]:
            qam = [0.2992+0.4824j, 0.4824+0.2992j, 0.5480+1.1732j, 1.1732+0.5480j, -0.2992+0.4824j, -0.4824+0.2992j, -0.5480+1.1732j, -1.1732+0.5480j, 0.2992-0.4824j, 0.4824-0.2992j, 0.5480-1.1732j, 1.1732-0.5480j, -0.2992-0.4824j, -0.4824-0.2992j, -0.5480-1.1732j, -1.1732-0.5480j]
        elif CR == [7, 15]:
            qam = [0.2592+0.4888j, 0.4888+0.2592j, 0.5072+1.1980j, 1.1980+0.5072j, -0.2592+0.4888j, -0.4888+0.2592j, -0.5072+1.1980j, -1.1980+0.5072j, 0.2592-0.4888j, 0.4888-0.2592j, 0.5072-1.1980j, 1.1980-0.5072j, -0.2592-0.4888j, -0.4888-0.2592j, -0.5072-1.1980j, -1.1980-0.5072j]
        elif CR == [9, 15]:
            qam = [0.2476+0.5204j, 0.5204+0.2476j, 0.4968+1.1916j, 1.1916+0.4968j, -0.2476+0.5204j, -0.5204+0.2476j, -0.4968+1.1916j, -1.1916+0.4968j, 0.2476-0.5204j, 0.5204-0.2476j, 0.4968-1.1916j, 1.1916-0.4968j, -0.2476-0.5204j, -0.5204-0.2476j, -0.4968-1.1916j, -1.1916-0.4968j]
    elif M == 64:
        if CR == [5, 15]:
            qam = [0.2040+0.4224j, 0.2208+0.4136j, 0.2440+0.5328j, 0.2744+0.5176j, 0.4224+0.2040j, 0.4136+0.2208j, 0.5328+0.2440j, 0.5176+0.2744j, 0.3408+1.4200j, 0.7624+1.2448j, 0.2960+1.1016j, 0.5760+0.9848j, 1.4200+0.3408j, 1.2448+0.7624j, 1.1016+0.2960j, 0.9848+0.5760j, -0.2040+0.4224j, -0.2208+0.4136j, -0.2440+0.5328j, -0.2744+0.5176j, -0.4224+0.2040j, -0.4136+0.2208j, -0.5328+0.2440j, -0.5176+0.2744j, -0.3408+1.4200j, -0.7624+1.2448j, -0.2960+1.1016j, -0.5760+0.9848j, -1.4200+0.3408j, -1.2448+0.7624j, -1.1016+0.2960j, -0.9848+0.5760j, 0.2040-0.4224j, 0.2208-0.4136j, 0.2440-0.5328j, 0.2744-0.5176j, 0.4224-0.2040j, 0.4136-0.2208j, 0.5328-0.2440j, 0.5176-0.2744j, 0.3408-1.4200j, 0.7624-1.2448j, 0.2960-1.1016j, 0.5760-0.9848j, 1.4200-0.3408j, 1.2448-0.7624j, 1.1016-0.2960j, 0.9848-0.5760j, -0.2040-0.4224j, -0.2208-0.4136j, -0.2440-0.5328j, -0.2744-0.5176j, -0.4224-0.2040j, -0.4136-0.2208j, -0.5328-0.2440j, -0.5176-0.2744j, -0.3408-1.4200j, -0.7624-1.2448j, -0.2960-1.1016j, -0.5760-0.9848j, -1.4200-0.3408j, -1.2448-0.7624j, -1.1016-0.2960j, -0.9848-0.5760j]
        elif CR == [7, 15]:
            qam = [0.1640+0.2992j, 0.1776+0.2912j, 0.3592+0.5712j, 0.6616+0.1328j, 0.2992+0.1640j, 0.2912+0.1776j, 0.5712+0.3592j, 0.1328+0.6616j, 0.3256+1.4792j, 0.8152+1.2760j, 0.2416+1.0360j, 0.5632+0.9024j, 1.4792+0.3256j, 1.2760+0.8152j, 1.0360+0.2416j, 0.9024+0.5632j, -0.1640+0.2992j, -0.1776+0.2912j, 0.3592+0.5712j, -0.6616+0.1328j, -0.2992+0.1640j, -0.2912+0.1776j, -0.5712+0.3592j, -0.1328+0.6616j, -0.3256+1.4792j, -0.8152+1.2760j, -0.2416+1.0360j, -0.5632+0.9024j, -1.4792+0.3256j, -1.2760+0.8152j, -1.0360+0.2416j, -0.9024+0.5632j, 0.1640-0.2992j, 0.1776-0.2912j, 0.3592-0.5712j, 0.6616-0.1328j, 0.2992-0.1640j, 0.2912-0.1776j, 0.5712-0.3592j, 0.1328-0.6616j, 0.3256-1.4792j, 0.8152-1.2760j, 0.2416-1.0360j, 0.5632-0.9024j, 1.4792-0.3256j, 1.2760-0.8152j, 1.0360-0.2416j, 0.9024-0.5632j, -0.1640-0.2992j, -0.1776-0.2912j, -0.3592-0.5712j, -0.6616-0.1328j, -0.2992-0.1640j, -0.2912-0.1776j, -0.5712-0.3592j, -0.1328-0.6616j, -0.3256-1.4792j, -0.8152-1.2760j, -0.2416-1.0360j, -0.5632-0.9024j, -1.4792-0.3256j, -1.2760-0.8152j, -1.0360-0.2416j, -0.9024-0.5632j]
        elif CR == [9, 15]:
            qam = [0.1280+0.3256j, 0.1600+0.3112j, 0.1592+0.7000j, 0.3840+0.6064j, 0.3256+0.1280j, 0.3112+0.1600j, 0.7000+0.1592j, 0.6064+0.3840j, 0.2912+1.4632j, 0.8288+1.2408j, 0.2072+1.0440j, 0.5912+0.8848j, 1.4632+0.2912j, 1.2408+0.8288j, 1.0440+0.2072j, 0.8848+0.5912j, -0.1280+0.3256j, -0.1600+0.3112j, -0.1592+0.7000j, -0.3840+0.6064j, -0.3256+0.1280j, -0.3112+0.1600j, -0.7000+0.1592j, -0.6064+0.3840j, -0.2912+1.4632j, -0.8288+1.2408j, -0.2072+1.0440j, -0.5912+0.8848j, -1.4632+0.2912j, -1.2408+0.8288j, -1.0440+0.2072j, -0.8848+0.5912j, 0.1280-0.3256j, 0.1600-0.3112j, 0.1592-0.7000j, 0.3840-0.6064j, 0.3256-0.1280j, 0.3112-0.1600j, 0.7000-0.1592j, 0.6064-0.3840j, 0.2912-1.4632j, 0.8288-1.2408j, 0.2072-1.0440j, 0.5912-0.8848j, 1.4632-0.2912j, 1.2408-0.8288j, 1.0440-0.2072j, 0.8848-0.5912j, -0.1280-0.3256j, -0.1600-0.3112j, -0.1592-0.7000j, -0.3840-0.6064j, -0.3256-0.1280j, -0.3112-0.1600j, -0.7000-0.1592j, -0.6064-0.3840j, -0.2912-1.4632j, -0.8288-1.2408j, -0.2072-1.0440j, -0.5912-0.8848j, -1.4632-0.2912j, -1.2408-0.8288j, -1.0440-0.2072j, -0.8848-0.5912j]
    else:
        raise Exception('M=={} not defined!'.format(M))

    qam = np.array(qam)
    constellation = Struct(qam=qam)
    return constellation

